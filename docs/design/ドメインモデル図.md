# Domain Modelï¼ˆã‚¢ã‚¤ãƒ‡ã‚¢å…±æœ‰ã‚¢ãƒ—ãƒª InspireHubï¼‰

> æœ€çµ‚æ›´æ–°: 2026-02-22
> APIä»•æ§˜: https://api.inspirehub.wtnqk.org/docs ã«æº–æ‹ 

---

# ğŸ”´ Aggregate: Postï¼ˆæŠ•ç¨¿ï¼‰

## Entity: Node
- aggregate: Post
- phase: 1
- description: èª²é¡Œ/ã‚¢ã‚¤ãƒ‡ã‚¢/ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æŠ•ç¨¿ãƒãƒ¼ãƒ‰ã€‚ã‚¢ãƒ—ãƒªå…¨ä½“ã®ä¸­å¿ƒã€‚

- fields:
  - id: string
  - type: NodeType(enum)  // "issue" | "idea" | "project"
  - title: string  // min 1æ–‡å­—
  - content: string
  - authorId: string  // User.id
  - authorName: string  // è¡¨ç¤ºç”¨ï¼ˆéæ­£è¦åŒ–ï¼‰
  - authorPicture: string  // è¡¨ç¤ºç”¨ï¼ˆéæ­£è¦åŒ–ï¼‰
  - parentNode: ParentNode?  // æ´¾ç”Ÿå…ƒ
  - tagIds: List\<TagId\>  // Tag ã®ç´ã¥ã‘ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³å´ã¯IDãƒªã‚¹ãƒˆã§æ‰±ã†ï¼‰
  - commentCount: number  // éæ­£è¦åŒ–ã‚«ã‚¦ãƒ³ã‚¿
  - reactions: Reactions  // ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³é›†è¨ˆï¼ˆValueObjectï¼‰
  - createdAt: datetime
  - updatedAt: datetime

- relations:
  - 1:N Comment via Comment.nodeId
  - 1:N Reaction via Reaction.nodeId
  - 0:1 Node parent via Node.parentNodeId
  - 0:N Node children via Node.parentNodeId
  - N:N Tag (â€»æ°¸ç¶šåŒ–ã§ã¯ node_tags ãƒ†ãƒ¼ãƒ–ãƒ«)

----------
## ValueObject: ParentNodeï¼ˆæ´¾ç”Ÿå…ƒã®å‚ç…§ç”¨ï¼‰
- aggregate: Post
- phase: 1
- description: è¦ªãƒãƒ¼ãƒ‰ã®è¦ç´„æƒ…å ±ã€‚Nodeå–å¾—æ™‚ã«åŸ‹ã‚è¾¼ã¾ã‚Œã‚‹ã€‚

- fields:
  - id: string
  - type: NodeType(enum)  // "issue" | "idea" | "project"
  - title: string

----------
## ValueObject: Reactionsï¼ˆãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³é›†è¨ˆï¼‰
- aggregate: Post
- phase: 1
- description: ãƒãƒ¼ãƒ‰ã«å¯¾ã™ã‚‹ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®é›†è¨ˆæƒ…å ±ã€‚å„ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ç¨®åˆ¥ã”ã¨ã®ä»¶æ•°ã¨ã€é–²è¦§ãƒ¦ãƒ¼ã‚¶ã®ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³çŠ¶æ…‹ã‚’ä¿æŒã€‚

- fields:
  - like: ReactionSummary
  - interested: ReactionSummary
  - wantToTry: ReactionSummary

## ValueObject: ReactionSummary
- aggregate: Post
- phase: 1
- fields:
  - count: number
  - isReacted: boolean  // é–²è¦§ãƒ¦ãƒ¼ã‚¶ãŒãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³æ¸ˆã¿ã‹

----------
## ValueObject: ReactedUserï¼ˆãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ï¼‰
- aggregate: Post
- phase: 1
- description: ç‰¹å®šã®ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ç¨®åˆ¥ã«å¯¾ã—ã¦ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æƒ…å ±ã€‚ä¸€è¦§å–å¾—APIã®ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³å¿œç­”è¦ç´ ã¨ã—ã¦ä½¿ç”¨ã€‚

- fields:
  - userId: string
  - userName: string | null
  - userPicture: string | null
  - reactedAt: datetime (ISO 8601)

----------
## ValueObject: ReactedUsersPageï¼ˆãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ãƒšãƒ¼ã‚¸ï¼‰
- aggregate: Post
- phase: 1
- description: ã‚«ãƒ¼ã‚½ãƒ«ãƒ™ãƒ¼ã‚¹ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ã®ãƒšãƒ¼ã‚¸å¿œç­”ã€‚`GET /nodes/{id}/reactions/{type}` ã®å¿œç­”ã¨ã—ã¦ä½¿ç”¨ã€‚

- fields:
  - users: List\<ReactedUser\>
  - nextCursor: string | null  // æ¬¡ãƒšãƒ¼ã‚¸å–å¾—ç”¨ã‚«ãƒ¼ã‚½ãƒ«ï¼ˆnull = æœ€çµ‚ãƒšãƒ¼ã‚¸ï¼‰
  - hasMore: boolean
  - total: number

---

## Entity: Comment
- aggregate: Post
- phase: 1
- description: ãƒãƒ¼ãƒ‰ã«ç´ã¥ãã‚³ãƒ¡ãƒ³ãƒˆã€‚ãƒã‚¹ãƒˆè¿”ä¿¡ï¼ˆ1éšå±¤ï¼‰ã¨ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ã‚’æŒã¤ã€‚

- fields:
  - id: string
  - nodeId: string
  - parentId: string?  // è¿”ä¿¡å…ˆã‚³ãƒ¡ãƒ³ãƒˆIDï¼ˆnull = ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ï¼‰
  - authorId: string
  - authorName: string  // è¡¨ç¤ºç”¨ï¼ˆéæ­£è¦åŒ–ï¼‰
  - authorPicture: string  // è¡¨ç¤ºç”¨ï¼ˆéæ­£è¦åŒ–ï¼‰
  - content: string  // min 1æ–‡å­—
  - mentions: List\<string\>  // ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³å¯¾è±¡ãƒ¦ãƒ¼ã‚¶IDãƒªã‚¹ãƒˆ
  - replies: List\<Comment\>  // å­ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆèª­ã¿å–ã‚Šå°‚ç”¨ã€APIå¿œç­”æ™‚ã®ã¿å±•é–‹ï¼‰
  - createdAt: datetime
  - updatedAt: datetime

- relations:
  - N:1 Node via Comment.nodeId
  - N:1 User via Comment.authorId
  - 0:1 Comment parent via Comment.parentId
  - 0:N Comment replies via Comment.parentId

---

## Entity: Reaction
- aggregate: Post
- phase: 1
- description: ãƒãƒ¼ãƒ‰ã«å¯¾ã™ã‚‹å„ãƒ¦ãƒ¼ã‚¶ã®ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€‚ãƒˆã‚°ãƒ«æ–¹å¼ï¼ˆåŒã˜APIã‚’å†å‘¼ã³å‡ºã—ã§è§£é™¤ï¼‰ã€‚

- fields:
  - id: string
  - nodeId: string
  - userId: string
  - type: ReactionType(enum)  // "like" | "interested" | "want_to_try"
  - createdAt: datetime

- relations:
  - N:1 Node via Reaction.nodeId
  - N:1 User via Reaction.userId

- APIå›ºæœ‰ã®æŒ¯ã‚‹èˆã„:
  - POST /nodes/{id}/like: ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒˆã‚°ãƒ«ï¼ˆè¿½åŠ /è§£é™¤ï¼‰
  - GET /nodes/{id}/reactions/{type}: ç‰¹å®šç¨®åˆ¥ã®ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§å–å¾—ï¼ˆPhase 1ç¢ºå®šï¼‰
    - ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: limit (10ã€œ100, ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ30), cursorï¼ˆã‚«ãƒ¼ã‚½ãƒ«ãƒ™ãƒ¼ã‚¹ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
    - å¿œç­”: ReactedUsersPage ValueObject

---

---

# ğŸŸ¦ Aggregate: UserProfileï¼ˆãƒ¦ãƒ¼ã‚¶ï¼‰

## Entity: User
- aggregate: UserProfile
- phase: 1
- description: æŠ•ç¨¿ã‚„ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ä¸»ä½“ã¨ãªã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€‚Googleèªè¨¼ã§ä½œæˆã•ã‚Œã‚‹ã€‚

- fields:
  - id: string
  - name: string
  - email: string  // Googleèªè¨¼ç”±æ¥
  - picture: string  // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒURLï¼ˆGoogleèªè¨¼ç”±æ¥ï¼‰
  - handle: string?  // Phase 2ã€œ
  - roleTag: string?  // "Backend" "Frontend" ãªã© Phase 2ã€œ
  - createdAt: datetime

- relations:
  - 1:N Node via Node.authorId
  - 1:N Comment via Comment.authorId
  - 1:N Reaction via Reaction.userId

---

# ğŸ” Aggregate: Authï¼ˆèªè¨¼ï¼‰

## ValueObject: AuthToken
- aggregate: Auth
- phase: 1
- description: Google ID Tokenæ¤œè¨¼å¾Œã«ç™ºè¡Œã•ã‚Œã‚‹JWTãƒˆãƒ¼ã‚¯ãƒ³ãƒšã‚¢ã€‚

- fields:
  - accessToken: string  // JWT Bearer Token
  - refreshToken: string  // ãƒˆãƒ¼ã‚¯ãƒ³æ›´æ–°ç”¨
  - expiresIn: number  // ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³æœ‰åŠ¹æœŸé™ï¼ˆç§’ï¼‰

---

# ğŸŸ¨ Aggregate: Taggingï¼ˆã‚¿ã‚°ç®¡ç†ï¼‰

## Entity: Tag
- aggregate: Tagging
- phase: 1 (APIã«å®Ÿè£…æ¸ˆã¿)
- description: ãƒ†ãƒ¼ãƒãƒ»æŠ€è¡“ãªã©ã®åˆ†é¡ç”¨ã‚¿ã‚°ï¼ˆãƒã‚¹ã‚¿ï¼‰ã€‚

- fields:
  - id: string
  - name: string  // ã‚¿ã‚°åï¼ˆmin 1æ–‡å­—ï¼‰
  - usageCount: number  // ä½¿ç”¨å›æ•°ï¼ˆèª­ã¿å–ã‚Šå°‚ç”¨ï¼‰
  - createdAt: datetime

- relations:
  - N:N Nodeï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³ä¸Šã¯ Node.tagIdsã€æ°¸ç¶šåŒ–ã§ã¯ node_tagsï¼‰

- APIå›ºæœ‰ã®æŒ¯ã‚‹èˆã„:
  - POST /tags: æ—¢å­˜ã‚¿ã‚°åã®å ´åˆã¯ä½œæˆã›ãšæ—¢å­˜ã‚’è¿”ã™ï¼ˆcreated: falseï¼‰
  - GET /tags/popular: ä½¿ç”¨å›æ•°é †ã§å–å¾—
  - GET /tags/suggest?q=: éƒ¨åˆ†ä¸€è‡´ã§å€™è£œè¿”å´
  - GET /tags/{name}/nodes: ã‚¿ã‚°åã§ãƒãƒ¼ãƒ‰ä¸€è¦§ã‚’ãƒ•ã‚£ãƒ«ã‚¿

---

# âš™ ã€DBè¨­è¨ˆæ™‚ã®æ³¨æ„ã€‘Persistenceï¼ˆæ°¸ç¶šåŒ–ãƒ¢ãƒ‡ãƒ«ï¼šãƒ‰ãƒ¡ã‚¤ãƒ³ã¨ã¯åˆ¥ã«å®šç¾©ï¼‰

## Table: tags
- id (PK)
- name
- created_at

## Table: node_tagsï¼ˆä¸­é–“ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰
- node_id (FK -> nodes.id)
- tag_id (FK -> tags.id)
- (PK: node_id + tag_id)

â€» ãƒ‰ãƒ¡ã‚¤ãƒ³ã«ã¯ NodeTag ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’ç™»å ´ã•ã›ãšã€
ã€€Node.aggregate å†…ã® `tagIds: List<TagId>` ã§æ‰±ã†ã€‚
â€» `usage_count` ã¯ node_tags ã®é›†è¨ˆã‹ã‚‰ç®—å‡ºã€‚

---

# ğŸŸ© Aggregate: AdminContentï¼ˆé‹å–¶ï¼‰

## Entity: AdminNotice
- aggregate: AdminContent
- phase: 2
- description: é‹å–¶ã‹ã‚‰ã®å›ºå®šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€‚

- fields:
  - id
  - title
  - content
  - updatedAt

- relations:
  - ãªã—ï¼ˆç‹¬ç«‹ãƒ¬ã‚³ãƒ¼ãƒ‰ï¼‰

---

# ğŸŸª Aggregate: Notificationï¼ˆé€šçŸ¥ï¼‰

## Entity: Notification
- aggregate: Notification
- phase: 2
- description: ã‚³ãƒ¡ãƒ³ãƒˆãƒ»ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ»æ´¾ç”Ÿä½œæˆãªã©ã®é€šçŸ¥ã€‚

- fields:
  - id
  - userId
  - type  // "reaction", "comment", "derivative"
  - nodeId
  - createdAt
  - isRead

- relations:
  - N:1 User via Notification.userId
  - N:1 Node via Notification.nodeId

---

# ğŸŸ§ View Modelsï¼ˆæ°¸ç¶šåŒ–ã—ãªã„æç”»å°‚ç”¨ï¼‰

## ViewModel: MapNode
- phase: 1
- fields:
  - nodeId
  - x, y
  - likeCount
  - interestedCount
  - wantToTryCount
  - commentCount

## ViewModel: MapEdge
- phase: 1
- fields:
  - fromNodeId
  - toNodeId

---

# ğŸ“Š å¤‰æ›´å±¥æ­´

## 2026-02-22: ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§å–å¾—æ©Ÿèƒ½ã‚’è¿½åŠ ï¼ˆPhase 1ç¢ºå®šï¼‰
- ReactedUser ValueObject ã‚’è¿½åŠ ï¼ˆuserId, userName, userPicture, reactedAtï¼‰
- ReactedUsersPage ValueObject ã‚’è¿½åŠ ï¼ˆã‚«ãƒ¼ã‚½ãƒ«ãƒ™ãƒ¼ã‚¹ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œï¼‰
- `GET /nodes/{id}/reactions/{type}` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’è¿½åŠ ï¼ˆlimit: 10ã€œ100, ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ30ï¼‰
- Reaction Entity ã« APIå›ºæœ‰ã®æŒ¯ã‚‹èˆã„è¨˜è¿°ã‚’è¿½åŠ 

## 2026-02-07: APIä»•æ§˜ (https://api.inspirehub.wtnqk.org/docs) ã«æº–æ‹ ã—ã¦æ›´æ–°
- Node.type ã« `"project"` ã‚’è¿½åŠ 
- ReactionType ã‚’ `"like" | "interested" | "want_to_try"` ã«å¤‰æ›´ï¼ˆæ—§: "like", "insight", "curious", "dev_interest"ï¼‰
- Reactions / ReactionSummary ValueObject ã‚’è¿½åŠ ï¼ˆAPIå¿œç­”ã®é›†è¨ˆæ§‹é€ ã«å¯¾å¿œï¼‰
- Comment ã« `parentId`, `mentions`, `replies`, `updatedAt`, `authorName`, `authorPicture` ã‚’è¿½åŠ 
- Node ã« `updatedAt`, `commentCount`, `authorName`, `authorPicture` ã‚’è¿½åŠ 
- User ã« `email`, `picture` ã‚’è¿½åŠ ï¼ˆGoogleèªè¨¼ç”±æ¥ï¼‰
- Tag ã® `label` â†’ `name` ã«å¤‰æ›´ã€`usageCount` ã‚’è¿½åŠ ã€`isActive` ã‚’å‰Šé™¤
- Auth Aggregateï¼ˆAuthToken ValueObjectï¼‰ã‚’æ–°è¦è¿½åŠ 
- ParentNode ValueObject ã‚’ç°¡ç•¥åŒ–ï¼ˆAPIå¿œç­”ã«åˆã‚ã›ã¦ id, type, title ã®ã¿ï¼‰
- ViewModel ã® MapNode ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚«ã‚¦ãƒ³ãƒˆåã‚’æ–°ReactionTypeã«æº–æ‹ 
