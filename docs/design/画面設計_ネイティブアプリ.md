# 画面設計 - ネイティブアプリ（Android/iOS）

## 画面一覧

### Phase1 画面一覧

| No | 画面名 | 画面種別 | 説明 | Phase | 遷移元 | 遷移先 |
|----|--------|---------|------|-------|--------|--------|
| 1 | ホーム（一覧） | タブ画面 | 課題・アイデアの一覧表示。タブで絞り込み（新着/課題/アイデア/自分）、ソート切替可能。 | Phase1 | Bottom Tab | 詳細、投稿種別選択 |
| 2 | マップ | タブ画面 | ノード関係の可視化。ノード（点）と派生関係（線）を表示。 | Phase1 | Bottom Tab | 詳細、投稿種別選択 |
| 3 | マイページ | タブ画面 | プロフィール、自分の投稿一覧、リアクションした投稿一覧。 | Phase1 | Bottom Tab | 詳細 |
| 4 | 投稿種別選択 | ボトムシート | 課題を投稿 / アイデアを投稿 の選択。 | Phase1 | FAB | 課題投稿、アイデア投稿 |
| 5 | 課題投稿 | モーダル | 課題投稿フォーム（タイトル・本文・タグ）。テンプレ・例文表示。 | Phase1 | 投稿種別選択 | ホーム |
| 6 | アイデア投稿 | モーダル | アイデア投稿フォーム（タイトル・本文・タグ）。テンプレ・例文表示。 | Phase1 | 投稿種別選択 | ホーム |
| 7 | 派生投稿 | モーダル | 派生アイデア投稿フォーム。元ノード引用表示。 | Phase1 | 詳細 | 詳細（元ノード） |
| 8 | 詳細 | Push/Pop | ノード詳細（本文・派生元/先・コメント・リアクション）。派生投稿・コメント投稿可能。 | Phase1 | ホーム、マップ、マイページ | 派生投稿、親ノード詳細 |

### Phase2 追加画面

| No | 画面名 | 画面種別 | 説明 | Phase | 遷移元 | 遷移先 |
|----|--------|---------|------|-------|--------|--------|
| 9 | ホーム（ホットタブ） | タブ内コンテンツ | アクティビティが多い投稿をホットスコア順で表示。 | Phase2 | ホーム | 詳細 |
| 10 | 検索 | タブ画面（検討） | キーワード検索、タグフィルタ。 | Phase2 | Bottom Tab（拡張） | 詳細 |
| 11 | 通知 | タブ画面（検討） | リアクション・コメント・派生の通知一覧。 | Phase2 | Bottom Tab（拡張）、プッシュ通知 | 詳細 |
| 12 | ユーザープロフィール | Push/Pop | 他ユーザーの詳細、投稿一覧、スキルタグ。 | Phase2 | 詳細、興味ユーザー一覧 | 詳細 |
| 13 | 興味ユーザー一覧 | ボトムシート | 「作ってみたい」を押したユーザー一覧（名前・肩書）。 | Phase2 | 詳細 | ユーザープロフィール |

### 画面種別の説明

- **タブ画面**: Bottom Navigation/Tab Barで切り替える主要画面
- **Push/Pop**: Navigation Stackで遷移する画面（戻るボタンで戻れる）
- **モーダル**: 一時的に表示され、完了/キャンセルで閉じる画面
- **ボトムシート**: 画面下部からスライドして表示される選択UI

---

## 設計方針

### iOS: Human Interface Guidelines準拠
- Tab Bar Navigation（主要機能への素早いアクセス）
- FAB（Floating Action Button）で投稿アクション
- Modal Presentation（投稿・詳細など一時的な画面）
- Navigation Stack（階層的な遷移）

### Android: Material Design準拠
- Bottom Navigation（主要タブ）
- FAB（Floating Action Button）で投稿アクション
- Navigation Component による画面遷移

### 共通設計思想
- **軽い関与**: リアクションは最小タップで完結
- **見て楽しい**: マップビューへ素早くアクセス
- **段階的エンゲージメント**: 閲覧 → リアクション → コメント → 投稿

---

## 画面構成（Phase1）

### 1. Tab Navigation（メイン3画面）

```
┌─────────────────────────────────┐
│     📱 アイデア共有アプリ         │
├─────────────────────────────────┤
│                                 │
│    [メインコンテンツエリア]        │
│                                 │
│                        ┌───┐    │
│                        │ ➕ │   │ ← FAB（投稿ボタン）
│                        └───┘    │
├─────────────────────────────────┤
│  🏠         🗺️        👤        │
│ ホーム      マップ    マイページ    │
└─────────────────────────────────┘
```

#### Tab 1: ホーム（一覧）🏠
- **機能**: 課題・アイデアの一覧表示
- **タブ切替**: 新着 | 課題 | アイデア | 自分（Phase2: ホット追加）
- **ソート**: 右上にソート切替ボタン（新着順 ⇅ 人気順）
- **デフォルト**: 新着タブ、新着順ソート
- **カード表示**: タイトル、本文プレビュー、リアクション数、コメント数
- **アクション**: カードタップ→詳細、リアクションアイコンタップ→即リアクション
- **FAB（右下）**: 投稿ボタン、タップで投稿種別選択モーダル表示

#### Tab 2: マップ 🗺️
- **機能**: ノード関係の可視化
- **表示**: ノード（点）+ 派生関係（線）
- **インタラクション**: ノードタップ→詳細、ピンチ→拡大縮小
- **Phase1**: シンプルな2D表示
- **FAB（右下）**: ホームと同じ投稿ボタン（全画面共通）

#### Tab 3: マイページ 👤
- **機能**: プロフィール、設定
- **表示**: 自分の投稿一覧、リアクションした投稿
- **Phase2**: スキルタグ編集
- **FAB**: マイページでは非表示（または表示継続、検討）

---

## 画面遷移フロー

### A. 閲覧フロー（最も基本）

```
ホーム（一覧）
    ↓ カードタップ
詳細画面
    ↓ 派生元タップ
親ノード詳細
    ↓ 戻る
詳細画面
    ↓ 戻る
ホーム（一覧）
```

### B. 投稿フロー

```
ホーム/マップ画面
    ↓ FABタップ
投稿種別選択（モーダル/ボトムシート）
├─ 課題を投稿
│     ↓
│  課題投稿画面（モーダル）
│     ↓ 投稿完了
│  元の画面（ホーム/マップ）※投稿完了アニメーション
│
└─ アイデアを投稿
      ↓
   アイデア投稿画面（モーダル）
      ↓ 投稿完了
   元の画面（ホーム/マップ）※投稿完了アニメーション
```

### C. 派生投稿フロー

```
詳細画面
    ↓ 「派生アイデアを投稿」ボタン
派生投稿画面（モーダル）
    ※元ノードのタイトルを引用表示
    ↓ 投稿完了
元ノード詳細画面
```

### D. リアクション・コメントフロー

```
一覧 or 詳細画面
    ↓ リアクションアイコンタップ
即座にリアクション付与/解除（アニメーション）
    ↓ コメントアイコンタップ
コメント入力（ボトムシート）
    ↓ 送信
コメント反映
```

### E. 作ってみたい興味ユーザー確認フロー

```
詳細画面
    ↓ 🤝 dev_interest数タップ
興味ユーザー一覧（ボトムシート）
    ※名前、肩書、プロフィールへのリンク
    ↓ ユーザータップ
ユーザープロフィール画面（Phase2）
```

---

## 画面別ナビゲーション詳細

### 1. ホーム（一覧）画面

#### Navigation Bar（上部）
```
┌─────────────────────────────────┐
│  ≡   アイデア共有        ⇅ 新着   │ ← ソート切替
├─────────────────────────────────┤
│ [新着|課題|アイデア|自分]         │ ← タブ（横スクロール可）
│                                 │   Phase2: ホット追加
└─────────────────────────────────┘
```

- **左**: メニュー（Phase2: 設定、お知らせ）
- **中央**: アプリタイトル
- **右**: ソート切替ボタン（新着順 ⇅ 人気順）
- **下**: タブバー（横スクロール可能）
  - Phase1: 新着 | 課題 | アイデア | 自分
  - Phase2: 🔥ホット | 新着 | 課題 | アイデア | 自分

#### カード構成
```
┌─────────────────────────────┐
│ 💡 課題/アイデア             │
│ タイトルタイトルタイトル       │
│                             │
│ 本文のプレビュー...           │
│                             │
│ 👤 投稿者名  📅 2時間前       │
│ 👍 12  💡 8  💬 3  🤝 2     │ ← リアクション・コメント数
└─────────────────────────────┘
```

#### FAB（Floating Action Button）
```
                        ┌───┐
                        │ ➕ │ ← 右下固定
                        └───┘
```
- **位置**: 画面右下固定
- **iOS**: システム標準のFABスタイル（SF Symbols使用）
- **Android**: Material Design FAB
- **タップ**: 投稿種別選択（課題/アイデア）をボトムシートで表示

#### インタラクション
- **カード全体タップ**: 詳細画面へ
- **リアクションアイコンタップ**: 即座にリアクション付与/解除
- **プルダウン**: リフレッシュ
- **FABタップ**: 投稿種別選択モーダル表示

---

### 2. マップ画面

#### Navigation Bar（上部）
```
┌─────────────────────────────────┐
│        アイデアマップ             │
│  [ リセット ]      [ フィルタ ]   │ ← Phase2
└─────────────────────────────────┘
```

#### マップ表示
```
        ○ Node1
       / \
      /   \
    ○      ○ Node3
  Node2     \
             ○ Node4
```

#### インタラクション
- **ノードタップ**: 詳細画面へ
- **ピンチイン/アウト**: 拡大縮小
- **ドラッグ**: パン（移動）
- **ノード長押し**: クイックプレビュー（Phase2）

---

### 3. 詳細画面

#### Navigation Bar（上部）
```
┌─────────────────────────────────┐
│  ← 詳細               ⋯  ★      │
└─────────────────────────────────┘
```
- **左**: 戻る
- **右**: その他メニュー（共有など Phase2）、ブックマーク（Phase2）

#### コンテンツ構成
```
┌─────────────────────────────────┐
│ 💡 課題/アイデア                  │
│ タイトルタイトルタイトル            │
│                                 │
│ 本文本文本文本文...               │
│                                 │
│ 👤 投稿者名  📅 2時間前           │
│                                 │
├─ 派生元 ─────────────────────────┤
│ 📌 元のアイデア: ○○○○            │ ← タップで親へ
├─ リアクション ───────────────────┤
│ 👍 12  💡 8  👀 5  🤝 2         │ ← タップでリアクション
├─ アクション ─────────────────────┤
│ [ 派生アイデアを投稿 ]            │
├─ コメント (3) ───────────────────┤
│ 👤 ユーザーA: コメント内容...      │
│ 👤 ユーザーB: コメント内容...      │
│                                 │
│ [ コメントを追加... ]             │
└─────────────────────────────────┘
```

#### 下部（固定）
- **コメント入力フィールド**: タップでキーボード表示
- **iOS**: インプットアクセサリービュー
- **Android**: ボトムシート展開

---

## 投稿関連画面

### 4. 投稿種別選択（ボトムシート/モーダル）

#### iOS実装
```
┌─────────────────────────────────┐
│                                 │
│  新規投稿                        │
│                                 │
│  📝 課題を投稿                   │
│  課題や困りごとを共有する          │
│                                 │
│  💡 アイデアを投稿               │
│  解決策やアイデアを投稿する        │
│                                 │
│  [ キャンセル ]                  │
└─────────────────────────────────┘
```

#### Android実装（ボトムシート）
```
┌─────────────────────────────────┐
│  新規投稿                        │
├─────────────────────────────────┤
│  📝 課題を投稿                   │
│  課題や困りごとを共有する          │
├─────────────────────────────────┤
│  💡 アイデアを投稿               │
│  解決策やアイデアを投稿する        │
└─────────────────────────────────┘
```

---

### 5. 投稿画面（モーダル）

#### Navigation Bar（上部）
```
┌─────────────────────────────────┐
│ キャンセル  課題を投稿    投稿    │
└─────────────────────────────────┘
```

#### フォーム
```
┌─────────────────────────────────┐
│ タイトル                         │
│ ［入力フィールド］                │
│                                 │
│ 本文                            │
│ ［入力フィールド（複数行）］       │
│                                 │
│ タグ（任意）                     │
│ ［# タグ入力］                   │
│                                 │
│ ────────────────────────────── │
│ 💡 例: 「リモートワークでの...」  │ ← テンプレ・例文
└─────────────────────────────────┘
```

#### インタラクション
- **キャンセル**: 確認ダイアログ → モーダル閉じる
- **投稿**: バリデーション → 投稿完了アニメーション → ホームへ

---

### 6. 派生投稿画面（モーダル）

#### Navigation Bar（上部）
```
┌─────────────────────────────────┐
│ キャンセル  派生アイデア   投稿   │
└─────────────────────────────────┘
```

#### フォーム
```
┌─────────────────────────────────┐
│ 派生元                           │
│ 📌 ○○○というアイデア              │ ← 引用表示
│                                 │
│ タイトル                         │
│ ［入力フィールド］                │
│                                 │
│ 本文                            │
│ ［入力フィールド（複数行）］       │
└─────────────────────────────────┘
```

---

### 7. マイページ

#### コンテンツ
```
┌─────────────────────────────────┐
│      👤 プロフィール写真          │
│         ユーザー名               │
│      Backend Engineer            │ ← Phase2
│                                 │
├─ 自分の投稿 ─────────────────────┤
│ 💡 アイデアタイトル1              │
│ 💡 アイデアタイトル2              │
│                                 │
├─ リアクションした投稿 ────────────┤
│ 💡 他人のアイデアタイトル1         │
│ 💡 他人のアイデアタイトル2         │
└─────────────────────────────────┘
```

---

## ジェスチャー・インタラクション

### iOS（Human Interface Guidelines準拠）

| ジェスチャー | 動作 |
|------------|------|
| タップ | カード→詳細、リアクション付与/解除 |
| スワイプ（右） | 戻る（Navigation Stack） |
| プルダウン | 一覧リフレッシュ |
| 長押し | クイックアクション（Phase2） |
| ピンチ | マップ拡大縮小 |

### Android（Material Design準拠）

| ジェスチャー | 動作 |
|------------|------|
| タップ | カード→詳細、リアクション付与/解除 |
| 戻るボタン | 前の画面へ |
| プルダウン | 一覧リフレッシュ |
| 長押し | コンテキストメニュー（Phase2） |
| ピンチ | マップ拡大縮大 |

---

## アニメーション・フィードバック

### 投稿完了
- **iOS**: Haptic Feedback + 「投稿しました！」トースト
- **Android**: Snackbar「投稿しました！」

### リアクション付与
- **共通**: アイコンがバウンド + カウント増加アニメーション
- **iOS**: Haptic Feedback（軽い振動）

### 画面遷移
- **iOS**: Push/Pop（右から左へスライド）、Modal（下から上へ）
- **Android**: Fragment Transaction（Slide/Fade）

---

## アクセシビリティ

### 対応項目（Phase1）
- **VoiceOver/TalkBack**: 全要素にラベル設定
- **Dynamic Type/Font Scaling**: テキストサイズ対応
- **Color Contrast**: WCAG AA準拠
- **タッチターゲット**: 最小44pt（iOS）/48dp（Android）

---

## Phase2以降の拡張

### 追加機能
- **ホットタブ**: 最近アクティビティが多い投稿を表示
  - ホットスコア = リアクション数 + (コメント数 × 2) + 時間減衰係数
  - 24時間以内のアクティビティを重視
- **検索画面**: タグフィルタ、キーワード検索
- **通知画面**: リアクション・コメント・派生の通知
- **ユーザープロフィール画面**: 他ユーザーの詳細
- **興味ユーザー一覧**: 作ってみたいユーザー表示

### ナビゲーション変更
- **ホームタブ拡張**: 🔥ホット | 新着 | 課題 | アイデア | 自分
- **検索タブ追加**: 5タブ構成に拡張検討
- **通知バッジ**: Tab Bar/Bottom Navigationにバッジ表示

---

## 実装時の技術的考慮事項

### KMP（Kotlin Multiplatform）での共通化
- **ナビゲーションロジック**: 共通化可能（画面遷移の状態管理）
- **UI**: iOS（SwiftUI）、Android（Jetpack Compose）で個別実装
- **ジェスチャー**: プラットフォーム固有実装

### 推奨ライブラリ
- **iOS**: SwiftUI Navigation Stack
- **Android**: Jetpack Navigation Component
- **共通**: Voyager（KMP対応ナビゲーションライブラリ）

---

## まとめ

### 画面構成サマリ

#### Phase1（8画面）
- **タブ画面（3画面）**: ホーム、マップ、マイページ
- **モーダル（3画面）**: 課題投稿、アイデア投稿、派生投稿
- **ボトムシート（1画面）**: 投稿種別選択
- **Push/Pop（1画面）**: 詳細

#### Phase2追加（5画面）
- **タブ内コンテンツ（1画面）**: ホーム（ホットタブ）
- **タブ画面（2画面）**: 検索、通知（検討）
- **Push/Pop（1画面）**: ユーザープロフィール
- **ボトムシート（1画面）**: 興味ユーザー一覧

### 設計のポイント
1. **3タブ構成**: ホーム・マップ・マイページ（投稿はFABで統一）
2. **FAB配置**: ホーム・マップ画面の右下に投稿FAB（X、Instagram等の主要SNSと同様）
3. **ホーム一覧の柔軟性**: タブ（新着/課題/アイデア/自分） × ソート（新着順/人気順）
4. **軽い操作**: リアクションは一覧からも可能
5. **段階的エンゲージメント**: 閲覧 → リアクション → コメント → 投稿
6. **プラットフォーム準拠**: HIG（iOS）、Material Design（Android）

### Phase1実装範囲（8画面）
- ✅ 3タブナビゲーション（ホーム・マップ・マイページ）
- ✅ FABによる投稿導線（投稿種別選択→投稿画面）
- ✅ ホーム一覧：新着 | 課題 | アイデア | 自分タブ
- ✅ ソート切替：新着順 ⇅ 人気順
- ✅ 詳細画面（コメント・リアクション・派生投稿）
- ✅ マップビュー（シンプル2D表示）
- ✅ マイページ（プロフィール・投稿一覧）

### Phase2で追加（5画面）
- **🔥 ホットタブ**: アクティビティが多い投稿のホットスコア算出・表示
- **検索・通知画面**: タブ拡張（3タブ→5タブ検討）
- **ユーザープロフィール**: 他ユーザー詳細、スキルタグ表示
- **興味ユーザー一覧**: 作ってみたいユーザー表示

### 画面遷移の特徴
- **タブ切替**: ホーム ⇄ マップ ⇄ マイページ（状態保持）
- **モーダル**: 投稿系画面は完了/キャンセルで閉じる
- **Push/Pop**: 詳細画面は階層的にスタック（戻るボタンで戻れる）
- **FABのメリット**: 主要SNSと同じUX、コンテキスト維持、3タブでシンプル
